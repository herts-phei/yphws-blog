---
title: "Is self-perceived weight associated with poorer diet and lower exercise?"
date: '2023-06-15'
categories: ['weight', 'diet', 'exercise']
format: html
editor: visual
---

```{r warning=FALSE, echo=FALSE, error=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(pacman)
library(sjmisc)
p_load(readr, tidyverse, PHEindicatormethods, ggplot2)

box::use(../../phei_functions/phei)


data_raw_cleaned <- read_csv("data/private/2022_data_raw_cleaned.csv") %>% 
  select(weight, age, sex, ethnicity, imd_quintile, portions, 
         contains(c("diet", "pa_")), clubs_sports, condition_physical, 
         worry_phys, cope_eat)


```

# Abstract

Young people within Hertfordshire have different self-perceived weights, the World Health Organisation state that this perception is not always in line with clinical definitions of normal weight, overweight and obesity. Body size disturbances and body dissatisfaction may be caused by the development of eating disorders. This brief analysis seeks to ascertain whether a student's self-perceived weight has a relationship with their physical activity levels and diet.

In the data collected for the latest YPHWS cohort, there were `r nrow(data_raw_cleaned %>% filter(!is.na(weight)))` students out of a total of `r nrow(data_raw_cleaned)` students have a reported self-perceived weight, representing `r round(nrow(data_raw_cleaned %>% filter(!is.na(weight)))/ nrow(data_raw_cleaned) * 100, 1)`% of the total student population.

```{r warning=FALSE, echo=FALSE, error=FALSE, message=FALSE, fig.cap="Figure 1. Proportion of self-perceived weights."}
data_raw_cleaned %>% 
  count(weight, name = "count") %>%
  add_count(wt = count, name = "total_count") %>% 
  mutate(weight = factor(weight, levels = c("Underweight", "Just Right", "Overweight",
                                            "Don't know/ Prefer not to say", "NA"))) %>% 
  PHEindicatormethods::phe_proportion(count, total_count, multiplier = 100) %>% 
  ggplot2::ggplot(ggplot2::aes(x = weight, y = value)) %>%
  phei$phei_bar(title = "Self-perceived weight",
                subtitle = element_blank(), position = "dodge", ymin = "lowercl", ymax = "uppercl") +
  ggplot2::ylab("Proportion") +
  ggplot2::xlab("Self-perceived weight") +
  ggplot2::theme(axis.text.x = element_text(angle = 0, vjust = 1, hjust = 0.5)) 
```

# Methods

The survey contains data on the three variables of interest:

<details>

<summary>Self-perceived weight</summary>

-   Self-perceived weight - How would you describe your current weight?
    -   Responses: `r paste(unique(data_raw_cleaned$weight), collapse = ", ")`

</details>

<details>

<summary>Physical activity</summary>

-   Physical activity - In the past week, on how many days have you done at least an hour (60 minutes or more) of physical activity, which was enough to raise your breathing rate?
    -   Responses: `r paste(sort(unique(data_raw_cleaned$pa_60)), collapse = ", ")` <!-- -   Sports club - Are you a part of or attending a sports group? --> <!--     -   Responses: `r paste(unique(data_raw_cleaned$clubs_sports), collapse = ", ")` -->

</details>

<details>

<summary>Diet</summary>

<!-- -   Breakfast - How often do you have breakfast? -->

<!-- -   Energy drinks - How often do you have energy drinks (not fizzy drinks)? -->

<!-- -   Fast food - How often do you have fast-food or takeaway? -->

<!-- -   Fizzy drinks - How often do you have fizzy drinks (not energy drinks)? -->

<!-- -   Sweets -How often do you have sweets? -->

<!-- -   Water - How often do you have water? -->

<!--     -   Responses: Rarely or never, Once a week or less, 2-3 days a week, On most days -->

-   Portions - How many portions of fruits or vegetables did you eat yesterday?
    -   Responses: 0-5+

</details>

<details>

<summary>Addional information</summary>

-   Sex - Please state your sex.
    -   Responses: Male, Female, Prefer not to say, Other, Transgender, Non-Binary
-   Age - How old are you?
    -   Responses - 10-19 years old
-   Ethnicity - What is your ethnic group?
    -   Responses - Various subgroups within White, Asian, Black, Mixed, also Prefer not to say, Other and NA
-   IMD quintile
    -   Responses - IMD quintile 1-5 (1 Most deprived - 5 least deprived)

</details>

# Results

## Physical activity

```{r, warning=FALSE, echo=FALSE, error=FALSE, message=FALSE, fig.cap="Figure 2. Plot of adjusted odds ratios and 95% confidence intervals for predictors of self-perceived weight being \"Just right\". Included within the model: Physical activity, Portions, Sex, Age, Ethnicity, IMD quintile."}

model_weight_pa_data <- data_raw_cleaned %>% 
  dplyr::filter(!is.na(weight)) %>% 
  mutate(weight_binomial = case_when(weight != "Just Right" ~ 0,
                            TRUE ~ 1),
         pa_60_binomial = case_when(pa_60 != "6-7" ~ 1,
                           TRUE ~ 0),
         weight_recommendations = case_when(weight != "Just Right" ~ "Below recommendations",
                                     TRUE ~ weight),
         pa_60_guideline = case_when(pa_60 != "6-7" ~ "Below Guidelines",
                                    TRUE ~ "At Guidelines"),
         sex_binomial = case_when(sex == "Male" ~ 0,
                                  sex == "Female" ~ 1,
                                  TRUE ~ 3))


pa_data <- model_weight_pa_data %>% 
  mutate(pa_60 = factor(pa_60, 
                           levels = c("none", "4-5", "6-7", "1-3")))

model_weight_pa <- glm(weight_binomial ~ pa_60 + portions + sex + age + ethnicity + imd_quintile,
                                            data = pa_data, 
                                            family = binomial)

odd_ratios_pa <- as.data.frame(exp(cbind(OR = coef(model_weight_pa), 
                                      confint(model_weight_pa)))) 

odd_ratios_pa$variable <- row.names(odd_ratios_pa)

odd_ratios_pa <- odd_ratios_pa %>% 
  mutate(variable = str_replace(variable, "pa_60", "Physical activity "),
         OR_text = round(OR,2)) %>% 
  filter(grepl("Physical activity ", variable)) 

ggplot(odd_ratios_pa, aes(x = OR, y = variable)) + 
  geom_vline(aes(xintercept = 1), size = .25, linetype = "dashed") +
  geom_errorbarh(aes(xmax = `2.5 %`, xmin = `97.5 %`), size = .5, height = 
                   .2, color = "gray50") +
  geom_point(size = 3.5, color = "blue") +
  theme_bw() +
  theme(panel.grid.minor = element_blank()) +
  ylab(str_wrap("Number of days at least 1 hour of physical activity was completed within a week",
       width = 50)) +
  xlab("Odds ratio") +
  # annotate("text", x = 1.1, y = 2, angle=90, size=3, label = "Not performing at least 1 hour of physical activity in a day within a week") +
  ggtitle(str_wrap("self-perceived weight depending on how many days days at least 1 hour of physical activity was performed within a week", width = 60),
          subtitle = str_wrap("Baseline - Not performing at least 1 hour of physical activity in a day within a week", width = 60))

```

Compared to the baseline of not performing at least 1 hour of physical activity in a day within a week, performing at least 1 hour of physical activity is associated with a significant increase in the likelihood of self-perceived weight being "Just right". Completing at least 1 hour of physical activity 1-3 days within a week is associated with a `r odd_ratios_pa$OR_text[odd_ratios_pa$variable == "Physical activity 1-3"]` time increase likelihood of self-perceived weight being "Just right". The likelihood of self-perceived weight being "Just right" increases with the number of days at least 1 hour of physical activity is completed within a week, completing 4-5 and 6-7 days is associated with an increase of `r odd_ratios_pa$OR_text[odd_ratios_pa$variable == "Physical activity 4-5"]` and `r odd_ratios_pa$OR_text[odd_ratios_pa$variable == "Physical activity 6-7"]`, respectively, times likelihood of self-perceived weight being "Just right".

## Portions

```{r, warning=FALSE, echo=FALSE, error=FALSE, message=FALSE, fig.cap="Figure 3. Plot of adjusted odds ratios and 95% confidence intervals for predictors of self-perceived weight being \"Just right\". Included within the model: Portions, Physical activity, Sex, Age, Ethnicity, IMD quintile."}

model_weight_pa_data <- data_raw_cleaned %>% 
  dplyr::filter(!is.na(weight)) %>% 
  mutate(weight_binomial = case_when(weight != "Just Right" ~ 0,
                            TRUE ~ 1),
         pa_60_binomial = case_when(pa_60 != "6-7" ~ 1,
                           TRUE ~ 0),
         weight_recommendations = case_when(weight != "Just Right" ~ "Below recommendations",
                                     TRUE ~ weight),
         pa_60_guideline = case_when(pa_60 != "6-7" ~ "Below Guidelines",
                                    TRUE ~ "At Guidelines"),
         sex_binomial = case_when(sex == "Male" ~ 0,
                                  sex == "Female" ~ 1,
                                  TRUE ~ 3))

portions_data <- model_weight_pa_data %>% 
  mutate(portions = to_factor(portions))

model_portions <- glm(weight_binomial ~ portions + pa_60 + sex + age + ethnicity + imd_quintile,
                                     data = portions_data, 
                                     family = binomial)

odd_ratios_portions <- as.data.frame(exp(cbind(OR = coef(model_portions), 
                                      confint(model_portions)))) 

odd_ratios_portions$variable <- row.names(odd_ratios_portions)

odd_ratios_portions <- odd_ratios_portions %>% 
  mutate(variable = str_replace(variable, "portions", "portions - "),
         variable = str_replace(variable, "5", "5+"),
         OR_text = round(OR,2)) %>% 
  filter(grepl("portions ", variable))

ggplot(odd_ratios_portions, aes(x = OR, y = variable)) + 
  geom_vline(aes(xintercept = 1), size = .25, linetype = "dashed") +
  geom_errorbarh(aes(xmax = `2.5 %`, xmin = `97.5 %`), size = .5, height = 
                   .2, color = "gray50") +
  geom_point(size = 3.5, color = "blue") +
  theme_bw() +
  theme(panel.grid.minor = element_blank()) +
  ylab("Portions of fruit or vegetables") +
  xlab("Odds ratio") +
  # annotate("text", x = 1.1, y = 2.5, angle=90, size=3, label = "No portions of fruit or vegetables") +
  ggtitle("Self-perceived weight depending on daily fruit or vegetables portions",
          subtitle = "Baseline - No portions of fruit or vegetables")

```

Compared to the baseline of not eating any portions or fruit or vegetables the previous day, eating 2 or more fruit or vegetables the previous day was associated with a significant increase in the likelihood of self-perceived weight being "Just right". Eating 4 or 5 portions or fruit or vegetables the previous day was a associated with a `r odd_ratios_portions$OR_text[odd_ratios_portions$variable == "portions - 4"]` and `r odd_ratios_portions$OR_text[odd_ratios_portions$variable == "portions - 5+"]`, respectively, times increase in likelihood of self-perceived weight being "Just right". Easting 1 portion or fruit or vegetables the previous day was not associated with an increase likelihood of self-perceived weight being "Just right".

## Ethnicity

```{r, warning=FALSE, echo=FALSE, error=FALSE, message=FALSE, fig.cap="Figure 4. Plot of adjusted odds ratios and 95% confidence intervals for predictors of self-perceived weight being \"Just right\". Included within the model: Ethnicity, Portions, Physical activity, Sex, Age, IMD quintile."}
eth_data <- model_weight_pa_data %>% 
  mutate(ethnicity = factor(ethnicity, 
                        levels = c("White - British", "Any other ethnic group", "Asian - Any other Asian background", "Asian - Bangladeshi", "Asian - Chinese", 
                                   "Asian - Indian", "Asian - Pakistani", "Black - African", "Black - Any other Black/African/Caribbean background",
                                   "Black - Caribbean", "Mixed - Any other Mixed background", "Mixed - White and Asian", 
                                   "Mixed - White and Black African", "Mixed - White and Black Caribbean", "Prefer not to say",
                                   "White - Any other White background", "White - Gypsy or Irish Traveller", "White - Irish", "NA" )))

model_weight_eth <- glm(weight_binomial ~ pa_60 + portions + sex + age + ethnicity + imd_quintile,
                       data = eth_data, 
                       family = binomial)

odd_ratios_eth <- as.data.frame(exp(cbind(OR = coef(model_weight_eth), 
                                         confint(model_weight_eth)))) 

odd_ratios_eth$variable <- row.names(odd_ratios_eth)

odd_ratios_eth <- odd_ratios_eth %>% 
  filter(grepl("ethnicity", variable)) %>% 
  mutate(variable = str_wrap(str_remove(variable, "ethnicity"), width = 30),
         OR_text = round(OR,2)) 
  

ggplot(odd_ratios_eth, aes(x = OR, y = variable)) + 
  geom_vline(aes(xintercept = 1), size = .25, linetype = "dashed") +
  geom_errorbarh(aes(xmax = `2.5 %`, xmin = `97.5 %`), size = .5, height = 
                   .2, color = "gray50") +
  geom_point(size = 3.5, color = "blue") +
  theme_bw() +
  theme(panel.grid.minor = element_blank()) +
  ylab(str_wrap("Ethnicity",
                width = 50)) +
  xlab("Odds ratio") +
  # annotate("text", x = 1.3, y = 3, angle=90, size=3, label = "Baseline - White British") +
  ggtitle(str_wrap("Self-perceived weight by Ethnicity", width = 60), 
           subtitle = "Baseline - White British")

```

Compared to the baseline value, White British, no ethnicity was associated with a significant increase in likelihood of their self-perceived weight being "Just right". However, any other Asian background, Indian, Prefer no to say and Gypsy or Irish traveler were associated with an increase likelihood of self-perceived weight being not "Just right".

## Deprivation

```{r, warning=FALSE, echo=FALSE, error=FALSE, message=FALSE, fig.cap="Figure 5. Plot of adjusted odds ratios and 95% confidence intervals for predictors of self-perceived weight being \"Just right\". Included within the model: IMD quintile, Ethnicity, Portions, Physical activity, Sex, Age."}
imd_data <- model_weight_pa_data %>% 
  mutate(imd_quintile = factor(imd_quintile, 
                            levels = c("Quintile 1 - Most Deprived", "Quintile 2" , "Quintile 3" , "Quintile 4" ,
                                       "Quintile 5 - Least Deprived", "unknown")))

model_weight_imd <- glm(weight_binomial ~ pa_60 + portions + sex + age + ethnicity + imd_quintile,
                        data = imd_data, 
                        family = binomial)

odd_ratios_imd <- as.data.frame(exp(cbind(OR = coef(model_weight_imd), 
                                          confint(model_weight_imd)))) 

odd_ratios_imd$variable <- row.names(odd_ratios_imd)

odd_ratios_imd <- odd_ratios_imd %>% 
  filter(grepl("imd_quintile", variable)) %>% 
  mutate(variable = str_wrap(str_remove(variable, "imd_quintile"), width = 30),
         OR_text = round(OR,2)) 


ggplot(odd_ratios_imd, aes(x = OR, y = variable)) + 
  geom_vline(aes(xintercept = 1), size = .25, linetype = "dashed") +
  geom_errorbarh(aes(xmax = `2.5 %`, xmin = `97.5 %`), size = .5, height = 
                   .2, color = "gray50") +
  geom_point(size = 3.5, color = "blue") +
  theme_bw() +
  theme(panel.grid.minor = element_blank()) +
  ylab(str_wrap("IMD Quintile",
                width = 50)) +
  xlab("Odds ratio") +
  # annotate("text", x = 0.95, y = 2, angle=90, size=3, label = "Baseline - IMD quintile 1 - Most Deprived") +
  ggtitle(str_wrap("Self-perceived weight by Deprivation", width = 60),
          subtitle = "Baseline - IMD quintile 1 - Most Deprived")

```

Compared to the baseline value of the most deprived IMD quintile, quintile 1, the less deprived areas are associated with a significant increase in the likelihood of self-perceived weight being "Just right". Being from IMD quintile 4 or 5 - least deprived is associated with a `r odd_ratios_imd$OR_text[odd_ratios_imd$variable == "Quintile 4"]` and `r odd_ratios_imd$OR_text[odd_ratios_imd$variable == "Quintile 5 - Least Deprived"]`, respectively, times increase in likelihood of self-perceived weight being "Just right".

# Conclusions

This report highlights that there is significant association between physical activity, fruit and vegetable consumption, ethnicity and deprivation on the impact on individuals self-perceived weight. Young people who are completing more physical activity are more likely to have reported a self-perceived weight as "Just right". Young people who are eating more fruit and vegetables are more likely to have reported a self-perceived weight as "Just right". Despite these findings, it cannot be said for certain whether increase physical activity and fruit and vegetable consumption causes improved self-perceived weight, it can only be claimed that there is a relationship between the variables.
